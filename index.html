<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <link href="//fonts.googleapis.com/css?family=.|Oswald:light,normal,bold|Oswald:light,normal,bold|Oswald:light,normal,bold|Raleway:light,normal,bold|Roboto:light,normal,bold" rel="stylesheet" type="text/css" />
  <style>
    body { color:#3288e2;background:#fbf7ef;margin:0;position:fixed;top:0;right:0;bottom:0;left:0; }
    
		svg {
  		font: 10px sans-serif;
		}

    .line {
      fill: none;
      stroke: #3288e2;
      stroke-width: 2px;
    }

    .title {
      font-family: Raleway;
      text-align: center;
      margin-top: 3%;
      font-weight: 600;
      font-size: 22px;
      letter-spacing: 0.15em;
    }

    .visualization {
      background: #ece5d6;
      margin-right: 5%;
      margin-left: 5%;
      margin-top: 24px;
      margin-bottom: 24px;
      text-align: center;
      padding-bottom: 24px;
      padding-top: 24px;
    }
    
  </style>
</head>

<body>
  <div class="title">EU Terrorism 1970-2019</div>
  <div class="visualization"></div>
  <script>
 
//Margin Convention     
  var margin = {top: 20, right: 30, bottom: 20, left: 100},
      width = 900 - margin.left - margin.right,
      height = 500 - margin.top - margin.bottom;
    
//Container  
  var svg = d3.select(".visualization").append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

//Saving the correct time format for D3 
  var parseDate = d3.timeParse("%b %Y");

//Saving the correct time format for the axis lables 
  var formatTime = d3.timeFormat("%b %Y");
    
//Defining the range for the time scale     
	var x = d3.scaleTime().range([0, width]);

  

//Defining the range for the linear scaling  
  var  y = d3.scaleLinear().range([height, 0]);
    
//Creating the line generator, defing by using accessor functions the date being the x variable and the price being the y variable  
var line = d3.line()
    .x(function(d) { console.log(x(d.date)); return x(d.date); })
    // .x(function(d) { console.log(x(d.date)); return 27; })
    .y(function(d) { console.log(y(d.Belgium)); return y(d.Belgium); });
 
////Creating the area generator, defing by using accessor functions the date being the x variable and the price being the y1 variable and the height being the y0 in order to avoid that the area that at the left up corner.   
   var area = d3.area()
    .x(function(d) { return x(d.date); })
  	.y0(height)
    .y1(function(d) { return y(d.Belgium); });
 
//Connecting to the data set    
  d3.text('EU_Terrorism.csv', function(error, raw) {

    var dsv = d3.dsvFormat(',')
    var data = dsv.parse(raw);
    data.forEach(function(d) {
      d.date = new Date(d.iyear)
      // debugÂ ger
      d.Belgium = parseInt(d.Belgium)
      console.log(d)
      // d.close = +d.close;
    });
 
//Defining the domain for the linear scaling using D3 extent which return the min and max
    x.domain(d3.extent(data, function(d) { return d.date; }));
    // debugger
    y.domain([0, d3.max(data.map(function(d) { return d.Belgium; }))])

    svg.append("path")
        .attr("class", "line")
        .attr("d", line(data));

    svg.append("path")
       .attr("class", "area")
       .attr("d", area(data))
    	 .style("fill-opacity", 0.1)
    	//  .style("fill", function(d) { return (data.iyear); });
    
// Calling and defining the x axis at the same time     
    svg.append("g")
        .attr("class", "axis--x")
        .attr("transform", "translate(0," + height + ")")  
        .call(d3.axisBottom(x)
              .ticks(8)
           		.tickFormat(formatTime));
    
//Calling and defining the y axis at the same time 
    svg.append("g")
        .attr("class", "axis--y")
        .call(d3.axisLeft(y)
              .ticks(4));  
  });
    
  </script>
</body>
